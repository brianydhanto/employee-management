
<div class="logout-container">
  <div class="logout" (click)="logout()">
    Logout &#10140;
  </div>
</div>
<div class="employee-header">
  <div style="width: 20%;">
    <button class="btn-gradient btn-primary" (click)="onAdd()">ADD EMPLOYEE</button>
  </div>
  <div style="width: 20%;" class="self-center">
    <input class="input-underline" type="text" placeholder="Search" (input)="onSearch()" [(ngModel)]="search"/>
  </div>
</div>
<div class="employee-table-container">
  <table class="employee-table">
    <thead>
      <tr>
        <th>No.</th>
        <th>
          <div class="sort" (click)="onSort('name')">
            <div class="self-center">Name</div>
            <div>
              @if(sort.header === 'name' && sort.sortBy === 'asc') {
                <div class="self-center">
                  &uArr;
                </div>
              } @else if(sort.header === 'name' && sort.sortBy === 'desc') {
                <div class="self-center">
                  &dArr;
                </div>
              }
            </div>
          </div>
          
        </th>
        <th>
          <div class="sort" (click)="onSort('birthDate')">
            <div class="self-center">Birth of Date</div>
            <div>
              @if(sort.header === 'birthDate' && sort.sortBy === 'asc') {
                <div class="self-center">
                  &uArr;
                </div>
              } @else if(sort.header === 'birthDate' && sort.sortBy === 'desc') {
                <div class="self-center">
                  &dArr;
                </div>
              }
            </div>
          </div>
        </th>
        <th>
          <div class="sort" (click)="onSort('email')">
            <div class="self-center">Email</div>
            <div>
              @if(sort.header === 'email' && sort.sortBy === 'asc') {
                <div class="self-center">
                  &uArr;
                </div>
              } @else if(sort.header === 'email' && sort.sortBy === 'desc') {
                <div class="self-center">
                  &dArr;
                </div>
              }
            </div>
          </div>
        </th>
        <th>
          <div class="sort" (click)="onSort('status')">
            <div class="self-center">Status</div>
            <div>
              @if(sort.header === 'status' && sort.sortBy === 'asc') {
                <div class="self-center">
                  &uArr;
                </div>
              } @else if(sort.header === 'status' && sort.sortBy === 'desc') {
                <div class="self-center">
                  &dArr;
                </div>
              }
            </div>
          </div>
        </th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody> 
      @for(employee of (employees$ | async) | slice: (currentPage-1)*itemsPerPage:(currentPage*itemsPerPage); track employee.username; let idx = $index) {
        <tr>
          <td>{{ (currentPage - 1) * itemsPerPage + idx + 1 }}.</td>
          <td>{{ employee.firstName + ' ' + employee.lastName}}</td>
          <td>{{ employee.birthDate | date }}</td>
          <td>{{ employee.email }}</td>
          <td>{{ employee.status }}</td>
          <td>
            <div class="btn-groups">
              <div>
                <button (click)="onDetail(employee)" class="btn-gradient btn-primary">DETAIL</button>
              </div>
              <div>
                <button (click)="onEdit(employee)" class="btn-gradient btn-edit">EDIT</button>
              </div>
              <div>
                <button (click)="onDelete(employee)" class="btn-gradient btn-delete">DELETE</button>
              </div>
            </div>
          </td>
        </tr>
      } 
    </tbody>
  </table>
</div>

<div class="pagination">
  <button 
    (click)="onChangePage(currentPage - 1)" 
    [disabled]="currentPage === 1">
    Prev
  </button>

  @for(page of [].constructor(totalPages); track $index; let i = $index) {
    <button 
      (click)="onChangePage(i + 1)"
      [class.active]="currentPage === i + 1">
      {{ i + 1 }}
    </button>
  }
  
  <button 
    (click)="onChangePage(currentPage + 1)" 
    [disabled]="currentPage === totalPages">
    Next
  </button>

  <div class="controls self-center">
    <select id="perPage" [(ngModel)]="itemsPerPage" (change)="currentPage=1">
      @for (size of pageSizes; track $index) {
        <option [value]="size">{{ size }}</option>
      }
    </select>
  </div>
</div>
